<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>{% block title %}{{ site_title }}{% endblock %}</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body class="theme-dark">
<nav class="navbar navbar-expand-md navbar-dark bg-gradient shadow-sm">
  <a class="navbar-brand font-logo" href="{{ url_for('index') }}">Alejandro Ines</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navMain">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div id="navMain" class="collapse navbar-collapse">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item {% if request.endpoint=='gallery' %}active{% endif %}">
        <a class="nav-link" href="{{ url_for('gallery') }}">Gallery</a>
      </li>
      <li class="nav-item {% if request.endpoint=='blog' %}active{% endif %}">
        <a class="nav-link" href="{{ url_for('blog') }}">Blog</a>
      </li>
      <li class="nav-item {% if request.endpoint=='about' %}active{% endif %}">
        <a class="nav-link" href="{{ url_for('about') }}">About</a>
      </li>
      <li class="nav-item {% if request.endpoint=='contact' %}active{% endif %}">
        <a class="nav-link" href="{{ url_for('contact') }}">Contact</a>
      </li>
    </ul>
    <form class="form-inline my-2 my-lg-0" onsubmit="return false;">
      <input id="siteSearch" class="form-control form-control-sm mr-2" type="search" placeholder="Search the site">
      <button id="searchBtn" class="btn btn-outline-light btn-sm mr-2" type="button">Go</button>
    </form>
    <button id="toggleTheme" class="btn btn-copper btn-sm" type="button" aria-pressed="false">Theme</button>
  </div>
</nav>

{% with msgs = get_flashed_messages(with_categories=True) %}
{% if msgs %}
<div class="container mt-3">
  {% for category, msg in msgs %}
  <div class="alert alert-{{ 'success' if category=='success' else 'warning' if category=='warning' else 'info' }} alert-dismissible fade show" role="alert">
    {{ msg }}
    <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span></button>
  </div>
  {% endfor %}
</div>
{% endif %}
{% endwith %}

{% block body %}{% endblock %}

<footer class="site-footer">
  <div class="container text-center">
    <small class="footer-text">&copy; <span id="year"></span> Alejandro Ines — All rights reserved.</small>
  </div>
</footer>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script src="{{ url_for('static', filename='scripts.js') }}"></script>

<style>
  /* Always black text + placeholder for search input */
  #siteSearch,
  #siteSearch::placeholder {
    color: #000 !important;
    opacity: 1;
  }

  /* Copper theme button */
  .btn-copper {
    background-color: #b87333;
    border: 2px solid #b87333;
    color: #fff !important;
    font-weight: 500;
    transition: all 0.3s ease;
  }
  .btn-copper:hover {
    background-color: #d68642;
    border-color: #d68642;
    color: #fff !important;
    box-shadow: 0 0 10px rgba(184,115,51,0.5);
  }

  /* Smooth fade-in for inline images */
  img {
    opacity: 0;
    transition: opacity 0.6s ease-in-out;
  }
  img.loaded {
    opacity: 1;
  }

  /* Background fade overlay */
  .bg-fade {
    position: relative;
    overflow: hidden;
  }
  .bg-fade::after {
    content: "";
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: #000;
    opacity: 1;
    transition: opacity 1s ease-in-out;
    pointer-events: none;
    z-index: 1;
  }
  .bg-fade.bg-loaded::after {
    opacity: 0;
  }
</style>

<script>
  // Fade-in for all <img>
  document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll("img").forEach(function (img) {
      if (img.complete) {
        img.classList.add("loaded");
      } else {
        img.addEventListener("load", function () {
          img.classList.add("loaded");
        });
      }
    });

    // Fade-in for background images
    document.querySelectorAll(".bg-fade").forEach(function (el) {
      const bg = window.getComputedStyle(el).backgroundImage;
      if (bg && bg !== "none") {
        const url = bg.slice(5, -2); // extract url("...") → ...
        const img = new Image();
        img.src = url;
        img.onload = function () {
          el.classList.add("bg-loaded");
        };
      }
    });
  });
</script>
</body>
</html>
